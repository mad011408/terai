# Workflow Configuration
# AI Terminal Agent - Workflow Definitions

# Workflow Definitions
workflows:
  # Code Review Workflow
  code_review:
    name: Code Review
    description: Review code for quality, security, and best practices
    version: "1.0"
    steps:
      - id: analyze_code
        name: Analyze Code Structure
        agent: code
        action: analyze
        parameters:
          focus:
            - structure
            - complexity
            - dependencies
        next: check_security

      - id: check_security
        name: Security Analysis
        agent: code
        action: security_scan
        parameters:
          scan_type: comprehensive
        next: check_style

      - id: check_style
        name: Style Check
        agent: code
        action: lint
        parameters:
          fix_auto: false
        next: generate_report

      - id: generate_report
        name: Generate Report
        agent: code
        action: report
        output: review_report

  # Research Workflow
  research:
    name: Research Task
    description: Comprehensive research on a topic
    version: "1.0"
    steps:
      - id: initial_search
        name: Initial Web Search
        agent: research
        action: search
        parameters:
          depth: broad
          num_sources: 10
        next: analyze_sources

      - id: analyze_sources
        name: Analyze Sources
        agent: research
        action: analyze
        parameters:
          extract_facts: true
          verify_claims: true
        next: deep_dive

      - id: deep_dive
        name: Deep Dive Research
        agent: research
        action: search
        parameters:
          depth: deep
          focus: gaps
        next: synthesize
        condition:
          type: quality_check
          threshold: 0.7

      - id: synthesize
        name: Synthesize Findings
        agent: research
        action: synthesize
        output: research_report

  # Debug Workflow
  debug:
    name: Debug Issue
    description: Debug and fix an issue
    version: "1.0"
    steps:
      - id: analyze_error
        name: Analyze Error
        agent: debug
        action: analyze
        parameters:
          include_stack_trace: true
          include_context: true
        next: identify_cause

      - id: identify_cause
        name: Identify Root Cause
        agent: debug
        action: root_cause
        next: search_solutions

      - id: search_solutions
        name: Search for Solutions
        agent: research
        action: search
        parameters:
          focus: solutions
          include_docs: true
        next: propose_fix

      - id: propose_fix
        name: Propose Fix
        agent: code
        action: fix
        parameters:
          test_fix: true
        next: verify_fix

      - id: verify_fix
        name: Verify Fix
        agent: debug
        action: verify
        output: fix_report

  # File Organization Workflow
  file_organization:
    name: File Organization
    description: Organize and clean up files
    version: "1.0"
    steps:
      - id: scan_files
        name: Scan Directory
        agent: file
        action: scan
        parameters:
          recursive: true
          include_hidden: false
        next: analyze_structure

      - id: analyze_structure
        name: Analyze Structure
        agent: file
        action: analyze
        next: propose_changes

      - id: propose_changes
        name: Propose Changes
        agent: file
        action: propose
        requires_approval: true
        next: apply_changes

      - id: apply_changes
        name: Apply Changes
        agent: file
        action: reorganize
        parameters:
          create_backup: true
        output: organization_report

  # Project Setup Workflow
  project_setup:
    name: Project Setup
    description: Initialize a new project
    version: "1.0"
    steps:
      - id: gather_requirements
        name: Gather Requirements
        agent: manager
        action: clarify
        parameters:
          questions:
            - project_type
            - language
            - framework
            - features
        next: create_structure

      - id: create_structure
        name: Create Project Structure
        agent: file
        action: create_structure
        next: setup_dependencies

      - id: setup_dependencies
        name: Setup Dependencies
        agent: terminal
        action: install
        parameters:
          package_manager: auto
        next: configure_tools

      - id: configure_tools
        name: Configure Development Tools
        agent: code
        action: configure
        parameters:
          tools:
            - linter
            - formatter
            - test_runner
        next: create_initial_code

      - id: create_initial_code
        name: Create Initial Code
        agent: code
        action: generate
        parameters:
          templates: true
        output: setup_complete

# State Machine Configurations
state_machines:
  task_execution:
    initial: pending
    states:
      pending:
        transitions:
          - event: start
            target: running
      running:
        transitions:
          - event: complete
            target: completed
          - event: fail
            target: failed
          - event: pause
            target: paused
      paused:
        transitions:
          - event: resume
            target: running
          - event: cancel
            target: cancelled
      completed:
        final: true
      failed:
        final: true
        on_enter: notify_failure
      cancelled:
        final: true

  agent_lifecycle:
    initial: idle
    states:
      idle:
        transitions:
          - event: activate
            target: active
      active:
        transitions:
          - event: process
            target: processing
          - event: deactivate
            target: idle
      processing:
        transitions:
          - event: complete
            target: active
          - event: error
            target: error_recovery
      error_recovery:
        transitions:
          - event: recover
            target: active
          - event: fail
            target: failed
      failed:
        final: true

# Parallel Execution Settings
parallel:
  enabled: true
  max_concurrent_tasks: 5
  max_concurrent_agents: 3
  batch_size: 10
  timeout_per_task: 300

# Handoff Configuration
handoffs:
  enabled: true
  max_depth: 5
  preserve_context: true
  context_window: 10
  timeout: 30
